<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Veille Technologique 2026 - BTS SISR</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    /* ==========================
       CSS Modernis√© 2026
       ========================== */
    * { margin:0; padding:0; box-sizing:border-box; }
    body {
      font-family: 'Inter', sans-serif;
      background: #f5f7fa;
      color: #1a202c;
      line-height: 1.6;
    }
    .container {
      max-width: 1200px;
      margin: 40px auto;
      padding: 0 20px;
    }
    header {
      text-align: center;
      margin-bottom: 50px;
    }
    header h1 {
      font-size: 2.8em;
      color: #2b6cb0;
      margin-bottom: 10px;
    }
    header p {
      font-size: 1.1em;
      color: #4a5568;
    }

    /* Stats */
    .stats {
      display: flex;
      justify-content: space-around;
      background: #edf2f7;
      border-radius: 12px;
      padding: 20px;
      margin: 30px 0;
      flex-wrap: wrap;
    }
    .stat-item {
      text-align: center;
      flex:1 1 200px;
      margin:10px;
    }
    .stat-item strong { display:block; font-size:1.1em; margin-bottom:5px; color:#2d3748; }
    .stat-item div { font-size:0.95em; color:#4a5568; }

    /* Veille grid */
    .veille-grid {
      display:grid;
      grid-template-columns:repeat(auto-fit, minmax(450px, 1fr));
      gap:30px;
    }

    .sujet {
      background:white;
      border-radius:15px;
      padding:25px;
      box-shadow:0 8px 25px rgba(0,0,0,0.08);
      transition:transform 0.3s ease;
    }
    .sujet:hover { transform: translateY(-5px); }

    .sujet h2 {
      font-size:1.5em;
      margin-bottom:15px;
      display:flex;
      align-items:center;
      justify-content:space-between;
    }

    .actualite-item {
      background:#f7fafc;
      border-left:4px solid #3182ce;
      padding:15px;
      border-radius:8px;
      margin-bottom:12px;
      transition: transform 0.2s ease;
    }
    .actualite-item:hover { transform: translateX(4px); }
    .date { font-size:0.85em; font-weight:600; color:#718096; }
    .source-badge {
      background:#3182ce;
      color:white;
      padding:2px 8px;
      border-radius:12px;
      font-size:0.8em;
      margin-left:5px;
    }

    .article-link {
      background:#38a169;
      color:white;
      padding:6px 12px;
      border-radius:6px;
      font-size:0.85em;
      text-decoration:none;
      display:inline-block;
      margin-top:10px;
      transition:background 0.3s ease;
    }
    .article-link:hover { background:#2f855a; }

    .controls {
      text-align:center;
      margin:20px 0;
    }
    .btn {
      background:#3182ce;
      color:white;
      border:none;
      padding:10px 20px;
      border-radius:6px;
      margin:0 10px;
      cursor:pointer;
      font-size:0.95em;
      transition:background 0.3s ease;
    }
    .btn:hover { background:#2b6cb0; }

    .article-count {
      background:#38a169;
      color:white;
      padding:6px 10px;
      border-radius:12px;
      font-size:0.8em;
    }

    .auto-update-status {
      text-align:center;
      background:#e2e8f0;
      padding:15px;
      border-radius:8px;
      margin-top:40px;
      color:#1a202c;
    }

    @media (max-width:768px){
      .veille-grid { grid-template-columns:1fr; }
      header h1 { font-size:2em; }
      .stats { flex-direction:column; gap:15px; }
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>üîç Veille Technologique 2026</h1>
      <p>BTS SISR - Accumulation automatique des articles avec analyses</p>

      <div class="stats">
        <div class="stat-item">
          <strong>üîÑ Mise √† jour</strong>
          <div>Automatique chaque 24h</div>
        </div>
        <div class="stat-item">
          <strong>üì∞ Articles stock√©s</strong>
          <div id="total-articles">Chargement...</div>
        </div>
        <div class="stat-item">
          <strong>üíæ Historique</strong>
          <div>Conservation 1 an</div>
        </div>
      </div>

      <div class="controls">
        <button class="btn" onclick="veilleSystem.manualRefresh()">üîÑ Rechercher maintenant</button>
        <button class="btn" onclick="veilleSystem.clearOldArticles()">üóëÔ∏è Nettoyer anciens articles</button>
        <button class="btn" onclick="veilleSystem.exportData()">üì§ Exporter la veille</button>
      </div>
    </header>

    <div id="veille-content">
      <p style="text-align:center; color:#718096;">Chargement des articles...</p>
    </div>

    <div class="auto-update-status">
      <p>üîÑ Prochaine mise √† jour : <span id="next-update">--:--</span></p>
      <p>üìÖ Derni√®re actualisation : <span id="last-update">--:--</span></p>
    </div>
  </div>

  <script>
    class VeilleTechnologique {
      constructor() {
        this.autoRefreshInterval = 24*60*60*1000; // 24h
        this.maxArticleAge = 365*24*60*60*1000; // 1 an
        this.dataFiles = {
          'iam-zero-trust':'veilles-data/iam-zero-trust.json',
          'network-automation':'veilles-data/network-automation.json'
        };
        this.articles = {};
      }

      async init() {
        await this.loadArticles();
        this.updateUI();
        this.updateLastUpdate();
        setInterval(()=>{ this.manualRefresh() }, this.autoRefreshInterval);
      }

      async loadArticles() {
        for (const [key, file] of Object.entries(this.dataFiles)) {
          try {
            const res = await fetch(file);
            this.articles[key] = res.ok ? await res.json() : [];
          } catch(e){
            console.error("Erreur chargement JSON", file, e);
            this.articles[key] = [];
          }
        }
      }

      async manualRefresh() {
        await this.loadArticles();
        this.cleanOldArticles();
        this.updateUI();
        this.updateLastUpdate();
      }

      // ‚úÖ M√©thode corrig√©e : conserve les articles manuels
      cleanOldArticles() {
        const cutoff = Date.now() - this.maxArticleAge;
        for (const key in this.articles) {
          this.articles[key] = this.articles[key].filter(article => {
            if (!article.auto) return true; // manuel = toujours conserv√©
            return new Date(article.date).getTime() > cutoff; // automatique = filtr√©
          });
        }
      }

      updateUI() {
        const container = document.getElementById('veille-content');
        let html='<div class="veille-grid">';
        for (const [key, items] of Object.entries(this.articles)) {
          html+=this.renderSujet(key, items);
        }
        html+='</div>';
        container.innerHTML=html;
        this.updateStats();
      }

      renderSujet(title, items) {
        const formattedTitle = title.replace(/-/g,' ').replace(/\b\w/g, c => c.toUpperCase());
        let articlesHTML = items.length>0 ? items.map(a=>`
          <div class="actualite-item">
            <span class="date">${new Date(a.date).toLocaleDateString('fr-FR')}</span>
            <span class="source-badge">${a.source}</span>
            <p><strong>${a.title}</strong></p>
            <p>${a.analysis}</p>
            <a class="article-link" href="${a.link}" target="_blank">üìñ Lire l'article</a>
          </div>
        `).join('') : '<p>üìù Aucun article trouv√©</p>';
        return `
          <div class="sujet">
            <h2>${formattedTitle} <span class="article-count">${items.length}</span></h2>
            <div class="actualites">${articlesHTML}</div>
          </div>
        `;
      }

      updateStats() {
        let total=0;
        for (const key in this.articles) total+=this.articles[key].length;
        document.getElementById('total-articles').textContent = total;
      }

      updateLastUpdate() {
        const now=new Date();
        document.getElementById('last-update').textContent=now.toLocaleString('fr-FR');
        document.getElementById('next-update').textContent=new Date(now.getTime()+this.autoRefreshInterval).toLocaleString('fr-FR');
      }

      clearOldArticles() {
        if(confirm("Supprimer les articles de plus de 1 an (automatiques seulement) ?")){
          this.cleanOldArticles();
          this.updateUI();
        }
      }

      exportData() {
        const data={exportDate:new Date().toISOString(), articles:this.articles};
        const blob=new Blob([JSON.stringify(data,null,2)],{type:'application/json'});
        const url=URL.createObjectURL(blob);
        const a=document.createElement('a');
        a.href=url;
        a.download=`veille-technologique-${new Date().toISOString().split('T')[0]}.json`;
        a.click();
        URL.revokeObjectURL(url);
      }
    }

    const veilleSystem = new VeilleTechnologique();
    document.addEventListener('DOMContentLoaded',()=>veilleSystem.init());
  </script>
</body>
</html>


